# 1. 延迟加载

首先我们先思考一个问题，假设：在一对多中，我们有一个用户，他有100个账户。

问题1：在查询用户的时候，要不要把关联的账户查出来？

问题2：在查询账户的时候，要不要把关联的用户查出来？

解答：在查询用户的时候，用户下的账户信息应该是我们什么时候使用，什么时候去查询。

​	   在查询账户的时候，账户的所属用户信息应该是随着账户查询时一起查询出来。

搞清楚这两个简单的问题后，我们就可以引出延迟加载和立即加载的特性。

**延迟加载**：在真正使用数据的时候才发起查询，不用的时候不查询关联的数据，延迟加载又叫按需查询（懒加载）

**立即加载**：不管用不用，只要一调用方法，马上发起查询。

**使用场景**：在对应的四种表关系中，一对多、多对多通常情况下采用延迟加载，多对一、一对一通常情况下采用立即加载。

# 2. 缓存

1. 概念介绍

```
1.什么是缓存：存在于内存中的临时数据
2.为什么使用缓存：减少和数据库的交互次数，提高执行效率
3.什么样的数据能适用缓存、什么样的数据不能适用缓存
1.适用于缓存：
  1.经常查询并且不经常改变的数据
  2.数据的正确与否对最终结果影响不大的
2.不适用于缓存
  1.经常改变的数据
  2.数据的正确对最终结果影响很大的
  例如：商品的库存、银行的汇率等
```

2. mybatis中的一级缓存和二级缓存

```
1.一级缓存
    1.一级缓存指的是Mybatis中SqlSession对象的缓存
    2.当我们执行查询语句之后，查询的结果会同时存入到SqlSession为我们提供的一块区域中，该区域的结构是一个Map，当我们再次查询相同的结果时，Mybatis会先去SqlSession中查询是否含有数据，有的话就直接拿来使用
    3.一级缓存消失的一些行为：
        1.SqlSession对象消失，Mybatis的一级缓存消失
        2.调用SqlSession对象的clearCache()、commit()、close()方法，Mybatis的一级缓存消失
        3.SqlSession对象的代理对象(就是执行具体查询方法的对象)调用的方法使用<insert>、<update>、<delete>等标签时，Mybatis的一级缓存消失
2.二级缓存
    1.二级缓存指的是Mybatis中SqlSessionFactory对象的缓存，由同一个SqlSessionFactory对象创建的SqlSession对象共享其缓存
    2.二级缓存的使用步骤：
        1.让Mybatis框架支持二级缓存(在主配置文件中配置)在<configuration>标签中添加：<settings><setting name="cacheEnabled" value="true"/><settings></configuration>
        2.让当前的映射文件支持二级缓存(在xxxDao.xml进行配置)在<mapper>标签中添加：<cache/>标签</mapper>
        3.让当前的操作支持二级缓存(在<select>标签中进行配置)在<select>标签中添加：useCache="true"</select>
```



在SqlMapConfig.xml中配置

```xml
<!--    配置开启二级缓存-->
<settings>
  <setting name="cacheEnabled" value="true"/>
</settings>
```

